{% extends 'base.html' %}
{% block title %}Crear Contacto{% endblock %}
{% block content %}
    {% if current_user.is_authenticated %}
        <div class="top-right">
            <span class="username-display">{{ current_user.username }}</span>
            <a href="{{ url_for('perfil') }}" class="gear-icon"><i class="fas fa-cog"></i></a>
            <a href="{{ url_for('logout') }}" class="logout-icon"><i class="fas fa-sign-out-alt"></i></a>
        </div>
    {% else %}
    {% endif %}

    <h1>Crear Nuevo Contacto</h1>
    <form method="POST" enctype="multipart/form-data" id="crearContactoForm">
        {{ form.csrf_token }}
        <div class="mb-3">
            {{ form.nombre.label(class="form-label") }}
            {{ form.nombre(class="rounded-pill form-control") }}
            {% if form.nombre.errors %}
                <ul class="errors">
                    {% for error in form.nombre.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.primer_apellido.label(class="form-label") }}
            {{ form.primer_apellido(class="rounded-pill form-control") }}
            {% if form.primer_apellido.errors %}
                <ul class="errors">
                    {% for error in form.primer_apellido.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.segundo_apellido.label(class="form-label") }}
            {{ form.segundo_apellido(class="rounded-pill form-control") }}
            {% if form.segundo_apellido.errors %}
                <ul class="errors">
                    {% for error in form.segundo_apellido.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.telefono.label(class="form-label") }}
            {{ form.telefono(class="rounded-pill form-control") }}
            {% if form.telefono.errors %}
                <ul class="errors">
                    {% for error in form.telefono.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.movil.label(class="form-label") }}
            {{ form.movil(class="rounded-pill form-control") }}
            {% if form.movil.errors %}
                <ul class="errors">
                    {% for error in form.movil.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.email.label(class="form-label") }}
            {{ form.email(class="rounded-pill form-control") }}
            {% if form.email.errors %}
                <ul class="errors">
                    {% for error in form.email.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.direccion.label(class="form-label") }}
            {{ form.direccion(class="rounded-pill form-control") }}
            {% if form.direccion.errors %}
                <ul class="errors">
                    {% for error in form.direccion.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.tipo_actividad.label(class="form-label") }}
            {{ form.tipo_actividad(class="rounded-pill form-select") }}
            {% if form.tipo_actividad.errors %}
                <ul class="errors">
                    {% for error in form.tipo_actividad.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.nota.label(class="form-label") }}
            {{ form.nota(class="form-control") }}
            {% if form.nota.errors %}
                <ul class="errors">
                    {% for error in form.nota.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.direccion_mapa.label(class="form-label") }}
            {{ form.direccion_mapa(class="form-control") }}
            {% if form.direccion_mapa.errors %}
                <ul class="errors">
                    {% for error in form.direccion_mapa.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3">
            {{ form.avatar.label(class="form-label") }}
            {{ form.avatar(class="rounded-pill form-control") }}
            {% if form.avatar.errors %}
                <ul class="errors">
                    {% for error in form.avatar.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div class="mb-3" style="display: none;">
            {{ form.submit(class="btn btn-primary") }}
        </div>
        <a href="{{ url_for('listar_contacto') }}" class="btn btn-secondary">Cancelar</a>
    </form>

    <style>
        .top-right {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .username-display {
            margin-right: 10px;
        }

        .gear-icon, .logout-icon {
            margin-left: 5px;
            color: #6c757d;
            text-decoration: none;
        }

        .gear-icon:hover, .logout-icon:hover {
            color: #007bff;
        }

        .errors {
            color: red;
            list-style-type: none;
            padding: 0;
            margin-top: 0.25rem;
            font-size: 0.875em;
        }

        .floating-button {
            position: fixed;
            bottom: 80px; /* Subir el bot√≥n */
            right: 20px;
            background-color: #28a745; /* Color verde para guardar */
            color: white;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            text-decoration: none;
        }

        .floating-button:hover {
            background-color: #1e7e34;
            color: white;
        }
    </style>

    <a href="#" onclick="document.getElementById('crearContactoForm').submit(); return false;" class="floating-button">
        <i class="fas fa-save"></i>
    </a>
{% endblock %}