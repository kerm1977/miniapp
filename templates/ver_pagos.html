{% extends 'base.html' %}
{% block content %}

    <title>Ver Pagos</title>
      <style>
        /* Estilos del botón flotante con nuevas clases */
        
        .floating-action-button {
            
            position: fixed !important; /* Forzar posición fija */
            bottom: 100px !important; /* Forzar distancia desde la parte inferior */
            right: 20px !important; /* Forzar distancia desde la parte derecha */
            background-color: orange !important; /* Forzar color azul */
            color: white !important; /* Forzar color de texto blanco */
            border-radius: 50% !important; /* Forzar bordes circulares */
            width: 56px !important; /* Forzar tamaño fijo */
            height: 56px !important;
            display: flex !important; /* Forzar flexbox para centrar contenido */
            justify-content: center !important; /* Centrar horizontalmente */
            align-items: center !important; /* Centrar verticalmente */
            font-size: 24px !important; /* Forzar tamaño del icono */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2) !important; /* Forzar sombra */
            z-index: 9999 !important; /* Forzar que esté por encima de todo */
            text-decoration: none !important; /* Forzar sin subrayado */
        }

        .floating-action-button:hover {
            background-color: #0056b3 !important; /* Forzar color azul más oscuro al pasar el mouse */
            color: white !important;
        }

        /* Asegurarse de que el icono dentro del botón también sea blanco */
        .floating-action-button-icon {
            color: white !important;
        }

        /* Estilos para las tarjetas de pago */
        .payment-card {
            border: none;
            border-radius: 0.75rem; /* Bordes más redondeados */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease-in-out;
        }

        .payment-card:hover {
            transform: translateY(-5px);
        }

        .payment-card-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #0056b3; /* Azul oscuro */
        }

        .payment-card-subtitle {
            font-size: 0.9rem;
            color: #6c757d; /* Gris */
        }

        .payment-detail {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .payment-detail strong {
            color: #343a40; /* Negro casi oscuro */
        }

        .payment-actions .btn {
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
    </style>


<div class="container mt-4">
    <h2 class="mb-4 text-center">Lista de Pagos</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mb-4">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    {% if pagos %}
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {% for pago in pagos %}
        <div class="col">
            <div class="card h-100 payment-card">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title payment-card-title">{{ pago.nombre_actividad }}</h5>
                    <h6 class="card-subtitle payment-card-subtitle mb-2">Actividad: {{ pago.actividad }}</h6>
                    <p class="card-text payment-detail"><strong>Fecha:</strong> {{ pago.fecha_registro.strftime('%Y-%m-%d %H:%M') }}</p>
                    <p class="card-text payment-detail"><strong>Costo Paquete:</strong> ₡{{ "%.2f"|format(pago.costo_paquete) }}</p>
                    <p class="card-text payment-detail"><strong>Cant. Personas:</strong> {{ pago.cantidad_personas }}</p>
                    <p class="card-text payment-detail"><strong>Tipo Cambio:</strong> {{ "%.4f"|format(pago.tipo_cambio) }}</p>
                    <p class="card-text payment-detail"><strong>Total Bruto Ind.:</strong> ₡{{ "%.2f"|format(pago.total_bruto_individual) }}</p>
                    <p class="card-text payment-detail"><strong>Total Bruto Gen. (CRC):</strong> ₡{{ "%.2f"|format(pago.total_bruto_general_colones) }}</p>
                    <p class="card-text payment-detail"><strong>Total Bruto Gen. (USD):</strong> ${{ "%.2f"|format(pago.total_bruto_general_dolar) }}</p>
                    <p class="card-text payment-detail"><strong>Ganancia P.P.:</strong> ₡{{ "%.2f"|format(pago.total_ganancia_pp) }}</p>
                    <p class="card-text payment-detail"><strong>Ganancia General:</strong> ₡{{ "%.2f"|format(pago.total_ganancia_general) }}</p>
                    <p class="card-text payment-detail"><strong>Nota:</strong> {{ pago.nota or 'N/A' }}</p>

                    <div class="mt-auto payment-actions">
                        <a href="{{ url_for('pagos.editar_pagos', id=pago.id) }}" class="btn btn-sm btn-warning">
                            <i class="fas fa-edit"></i> Editar
                        </a>
                        <form action="{{ url_for('pagos.borrar_pagos', id=pago.id) }}" method="POST" class="d-inline" onsubmit="return confirm('¿Estás seguro de que quieres borrar este pago?');">
                            <input type="hidden" name="csrf_token" value="{{ generate_csrf() }}">
                            <button type="submit" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash-alt"></i> Borrar
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info text-center" role="alert">
        No hay pagos registrados aún. ¡Crea uno nuevo!
    </div>
    {% endif %}
</div>



<a href="{{ url_for('pagos.crear_pagos') }}" class="floating-action-button">
    <i class="fas fa-plus"></i>
</a>


{% endblock %}
